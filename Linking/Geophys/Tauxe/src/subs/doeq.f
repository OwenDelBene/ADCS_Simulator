c___________________________________________________________
	subroutine doeq(phi,theta,n)

	dimension phi(*),theta(*)
	dimension xp(10000),yp(10000)
        pi=2.0*asin(1.0)
        rad=pi/180
	write(*,'(a)')'frame none'
	write(*,'(a)')'file *'
	write(*,'(a)')'dash 0'
	write(*,'(a)')'read 255'
	write(*,*)'1.00000 0.00000'
	write(*,*)'0.96000 0.00000'
	write(*,*)'1.00000 0.00000'
	write(*,*)'0.99939 0.03490'
	write(*,*)'0.99756 0.06976'
	write(*,*)'0.99452 0.10453'
	write(*,*)'0.99027 0.13917'
	write(*,*)'0.98481 0.17365'
	write(*,*)'0.94542 0.16670'
	write(*,*)'0.98481 0.17365'
	write(*,*)'0.97815 0.20791'
	write(*,*)'0.97030 0.24192'
	write(*,*)'0.96126 0.27564'
	write(*,*)'0.95106 0.30902'
	write(*,*)'0.93969 0.34202'
	write(*,*)'0.90210 0.32834'
	write(*,*)'0.93969 0.34202'
	write(*,*)'0.92718 0.37461'
	write(*,*)'0.91355 0.40674'
	write(*,*)'0.89879 0.43837'
	write(*,*)'0.88295 0.46947'
	write(*,*)'0.86603 0.50000'
	write(*,*)'0.83138 0.48000'
	write(*,*)'0.86603 0.50000'
	write(*,*)'0.84805 0.52992'
	write(*,*)'0.82904 0.55919'
	write(*,*)'0.80902 0.58779'
	write(*,*)'0.78801 0.61566'
	write(*,*)'0.76604 0.64279'
	write(*,*)'0.73540 0.61708'
	write(*,*)'0.76604 0.64279'
	write(*,*)'0.74314 0.66913'
	write(*,*)'0.71934 0.69466'
	write(*,*)'0.69466 0.71934'
	write(*,*)'0.66913 0.74314'
	write(*,*)'0.64279 0.76604'
	write(*,*)'0.61708 0.73540'
	write(*,*)'0.64279 0.76604'
	write(*,*)'0.61566 0.78801'
	write(*,*)'0.58779 0.80902'
	write(*,*)'0.55919 0.82904'
	write(*,*)'0.52992 0.84805'
	write(*,*)'0.50000 0.86603'
	write(*,*)'0.48000 0.83138'
	write(*,*)'0.50000 0.86603'
	write(*,*)'0.46947 0.88295'
	write(*,*)'0.43837 0.89879'
	write(*,*)'0.40674 0.91355'
	write(*,*)'0.37461 0.92718'
	write(*,*)'0.34202 0.93969'
	write(*,*)'0.32834 0.90210'
	write(*,*)'0.34202 0.93969'
	write(*,*)'0.30902 0.95106'
	write(*,*)'0.27564 0.96126'
	write(*,*)'0.24192 0.97030'
	write(*,*)'0.20791 0.97815'
	write(*,*)'0.17365 0.98481'
	write(*,*)'0.16670 0.94542'
	write(*,*)'0.17365 0.98481'
	write(*,*)'0.13917 0.99027'
	write(*,*)'0.10453 0.99452'
	write(*,*)'0.06976 0.99756'
	write(*,*)'0.03490 0.99939'
	write(*,*)'0.00000 1.00000'
	write(*,*)'0.00000 0.96000'
	write(*,*)'0.00000 1.00000'
	write(*,*)'-0.03490 0.99939'
	write(*,*)'-0.06976 0.99756'
	write(*,*)'-0.10453 0.99452'
	write(*,*)'-0.13917 0.99027'
	write(*,*)'-0.17365 0.98481'
	write(*,*)'-0.16670 0.94542'
	write(*,*)'-0.17365 0.98481'
	write(*,*)'-0.20791 0.97815'
	write(*,*)'-0.24192 0.97030'
	write(*,*)'-0.27564 0.96126'
	write(*,*)'-0.30902 0.95106'
	write(*,*)'-0.34202 0.93969'
	write(*,*)'-0.32834 0.90211'
	write(*,*)'-0.34202 0.93969'
	write(*,*)'-0.37461 0.92718'
	write(*,*)'-0.40674 0.91355'
	write(*,*)'-0.43837 0.89879'
	write(*,*)'-0.46947 0.88295'
	write(*,*)'-0.50000 0.86603'
	write(*,*)'-0.48000 0.83138'
	write(*,*)'-0.50000 0.86603'
	write(*,*)'-0.52992 0.84805'
	write(*,*)'-0.55919 0.82904'
	write(*,*)'-0.58778 0.80902'
	write(*,*)'-0.61566 0.78801'
	write(*,*)'-0.64279 0.76604'
	write(*,*)'-0.61708 0.73540'
	write(*,*)'-0.64279 0.76604'
	write(*,*)'-0.66913 0.74315'
	write(*,*)'-0.69466 0.71934'
	write(*,*)'-0.71934 0.69466'
	write(*,*)'-0.74314 0.66913'
	write(*,*)'-0.76604 0.64279'
	write(*,*)'-0.73540 0.61708'
	write(*,*)'-0.76604 0.64279'
	write(*,*)'-0.78801 0.61566'
	write(*,*)'-0.80902 0.58779'
	write(*,*)'-0.82904 0.55919'
	write(*,*)'-0.84805 0.52992'
	write(*,*)'-0.86603 0.50000'
	write(*,*)'-0.83138 0.48000'
	write(*,*)'-0.86603 0.50000'
	write(*,*)'-0.88295 0.46947'
	write(*,*)'-0.89879 0.43837'
	write(*,*)'-0.91355 0.40674'
	write(*,*)'-0.92718 0.37461'
	write(*,*)'-0.93969 0.34202'
	write(*,*)'-0.90210 0.32834'
	write(*,*)'-0.93969 0.34202'
	write(*,*)'-0.95106 0.30902'
	write(*,*)'-0.96126 0.27564'
	write(*,*)'-0.97030 0.24192'
	write(*,*)'-0.97815 0.20791'
	write(*,*)'-0.98481 0.17365'
	write(*,*)'-0.94542 0.16670'
	write(*,*)'-0.98481 0.17365'
	write(*,*)'-0.99027 0.13917'
	write(*,*)'-0.99452 0.10453'
	write(*,*)'-0.99756 0.06976'
	write(*,*)'-0.99939 0.03490'
	write(*,*)'-1.00000 0.00000'
	write(*,*)'-0.96000 0.00000'
	write(*,*)'-1.00000 0.00000'
	write(*,*)'-0.99939 -0.03490'
	write(*,*)'-0.99756 -0.06976'
	write(*,*)'-0.99452 -0.10453'
	write(*,*)'-0.99027 -0.13917'
	write(*,*)'-0.98481 -0.17365'
	write(*,*)'-0.94542 -0.16670'
	write(*,*)'-0.98481 -0.17365'
	write(*,*)'-0.97815 -0.20791'
	write(*,*)'-0.97030 -0.24192'
	write(*,*)'-0.96126 -0.27564'
	write(*,*)'-0.95106 -0.30902'
	write(*,*)'-0.93969 -0.34202'
	write(*,*)'-0.90211 -0.32834'
	write(*,*)'-0.93969 -0.34202'
	write(*,*)'-0.92718 -0.37461'
	write(*,*)'-0.91355 -0.40674'
	write(*,*)'-0.89879 -0.43837'
	write(*,*)'-0.88295 -0.46947'
	write(*,*)'-0.86603 -0.50000'
	write(*,*)'-0.83138 -0.48000'
	write(*,*)'-0.86603 -0.50000'
	write(*,*)'-0.84805 -0.52992'
	write(*,*)'-0.82904 -0.55919'
	write(*,*)'-0.80902 -0.58778'
	write(*,*)'-0.78801 -0.61566'
	write(*,*)'-0.76604 -0.64279'
	write(*,*)'-0.73540 -0.61708'
	write(*,*)'-0.76604 -0.64279'
	write(*,*)'-0.74315 -0.66913'
	write(*,*)'-0.71934 -0.69466'
	write(*,*)'-0.69466 -0.71934'
	write(*,*)'-0.66913 -0.74314'
	write(*,*)'-0.64279 -0.76604'
	write(*,*)'-0.61708 -0.73540'
	write(*,*)'-0.64279 -0.76604'
	write(*,*)'-0.61566 -0.78801'
	write(*,*)'-0.58779 -0.80902'
	write(*,*)'-0.55919 -0.82904'
	write(*,*)'-0.52992 -0.84805'
	write(*,*)'-0.50000 -0.86603'
	write(*,*)'-0.48000 -0.83138'
	write(*,*)'-0.50000 -0.86603'
	write(*,*)'-0.46947 -0.88295'
	write(*,*)'-0.43837 -0.89879'
	write(*,*)'-0.40674 -0.91355'
	write(*,*)'-0.37461 -0.92718'
	write(*,*)'-0.34202 -0.93969'
	write(*,*)'-0.32834 -0.90210'
	write(*,*)'-0.34202 -0.93969'
	write(*,*)'-0.30902 -0.95106'
	write(*,*)'-0.27564 -0.96126'
	write(*,*)'-0.24192 -0.97030'
	write(*,*)'-0.20791 -0.97815'
	write(*,*)'-0.17365 -0.98481'
	write(*,*)'-0.16670 -0.94542'
	write(*,*)'-0.17365 -0.98481'
	write(*,*)'-0.13917 -0.99027'
	write(*,*)'-0.10453 -0.99452'
	write(*,*)'-0.06976 -0.99756'
	write(*,*)'-0.03490 -0.99939'
	write(*,*)'0.00000 -1.00000'
	write(*,*)'0.00000 -0.96000'
	write(*,*)'0.00000 -1.00000'
	write(*,*)'0.03490 -0.99939'
	write(*,*)'0.06976 -0.99756'
	write(*,*)'0.10453 -0.99452'
	write(*,*)'0.13917 -0.99027'
	write(*,*)'0.17365 -0.98481'
	write(*,*)'0.16670 -0.94542'
	write(*,*)'0.17365 -0.98481'
	write(*,*)'0.20791 -0.97815'
	write(*,*)'0.24192 -0.97030'
	write(*,*)'0.27564 -0.96126'
	write(*,*)'0.30902 -0.95106'
	write(*,*)'0.34202 -0.93969'
	write(*,*)'0.32834 -0.90211'
	write(*,*)'0.34202 -0.93969'
	write(*,*)'0.37461 -0.92718'
	write(*,*)'0.40674 -0.91355'
	write(*,*)'0.43837 -0.89879'
	write(*,*)'0.46947 -0.88295'
	write(*,*)'0.50000 -0.86603'
	write(*,*)'0.48000 -0.83138'
	write(*,*)'0.50000 -0.86603'
	write(*,*)'0.52992 -0.84805'
	write(*,*)'0.55919 -0.82904'
	write(*,*)'0.58778 -0.80902'
	write(*,*)'0.61566 -0.78801'
	write(*,*)'0.64279 -0.76604'
	write(*,*)'0.61708 -0.73540'
	write(*,*)'0.64279 -0.76604'
	write(*,*)'0.66913 -0.74315'
	write(*,*)'0.69466 -0.71934'
	write(*,*)'0.71934 -0.69466'
	write(*,*)'0.74314 -0.66913'
	write(*,*)'0.76604 -0.64279'
	write(*,*)'0.73540 -0.61708'
	write(*,*)'0.76604 -0.64279'
	write(*,*)'0.78801 -0.61566'
	write(*,*)'0.80902 -0.58779'
	write(*,*)'0.82904 -0.55919'
	write(*,*)'0.84805 -0.52992'
	write(*,*)'0.86602 -0.50000'
	write(*,*)'0.83138 -0.48000'
	write(*,*)'0.86602 -0.50000'
	write(*,*)'0.88295 -0.46947'
	write(*,*)'0.89879 -0.43837'
	write(*,*)'0.91355 -0.40674'
	write(*,*)'0.92718 -0.37461'
	write(*,*)'0.93969 -0.34202'
	write(*,*)'0.90210 -0.32834'
	write(*,*)'0.93969 -0.34202'
	write(*,*)'0.95106 -0.30902'
	write(*,*)'0.96126 -0.27564'
	write(*,*)'0.97030 -0.24192'
	write(*,*)'0.97815 -0.20791'
	write(*,*)'0.98481 -0.17365'
	write(*,*)'0.94542 -0.16670'
	write(*,*)'0.98481 -0.17365'
	write(*,*)'0.99027 -0.13917'
	write(*,*)'0.99452 -0.10453'
	write(*,*)'0.99756 -0.06976'
	write(*,*)'0.99939 -0.03490'
	write(*,*)'1.00000 0.00000'
	write(*,*)'0.96000 0.00000'
	write(*,*)'1.00000 0.00000'
	write(*,'(a)')'symbol 13  .10'
	write(*,'(a)')'read 8'
	write(*,*)'0.9090389964428949 0.0'
	write(*,*)'0.8111596085098743 0.0'
	write(*,*)'0.7071068377822700 0.0'
	write(*,*)'0.5976725402193242 0.0'
	write(*,*)'0.4836895866901422 0.0'
	write(*,*)'0.3660255138979287 0.0'
	write(*,*)'0.2455757377858851 0.0'
	write(*,*)'0.1232569327694083 0.0'
	write(*,'(a)')'symbol 4  .10'
	write(*,'(a)')'read 1'
	write(*,'(a)')'0 0'
	if(n.eq.0)return
	np=0
	do 10 i=1,n	
	dip=90-theta(i)/rad
	 if(dip.ge.0) then
	  np=np+1
	  call dotpr_xyz(theta(i),phi(i),1.,x,y,z)
	  call xymap(x,y,z,xp(np),yp(np))	
	 endif
 10	continue
 4	format(a5,i6)
	if(np.gt.0)then
	 write(*,'(a)')'symb 19 .2'
	 write(*,'(a)')'fill'
	 write(*,4)'read ',np
	 do 21 i=1,np
 21	  write(*,*)yp(i),xp(i)
	endif
	np=0
 12	do 11 i=1,n	
	dip=90-theta(i)/rad
	 if(dip.lt.0) then
	  np=np+1
	  call dotpr_xyz(theta(i),phi(i),1.,x,y,z)
	  call xymap(x,y,z,xp(np),yp(np))	
	 endif
 11	continue
	if(np.gt.0)then
	 write(*,'(a)')'symb 16 .2'
	 write(*,4)'read ',np
	 do 25 i=1,np
 25	  write(*,*)yp(i),xp(i)
	endif
	return
	end
c_____________________________________________________
	subroutine xymap(x,y,z,xp,yp)
	  if(z.eq.1) then
	    x=0
	    y=0
	    return 
 	  endif
	if(z.lt.0) then
	z=-z
	endif
    	  r=sqrt(1.-z)/(sqrt(x*x+y*y))
	  xp=x*r
	  yp=y*r
	return
	end
